---
title: "projetoR"
author: "Lucas Alves e Matheus Florentino"
date: "21/09/2022"
output: html_document
---


```{r echo=FALSE, message=FALSE, warning=FALSE}

library(tidyverse)
library(DT)
library(knitr)
```

# Análise sobre a campanha de vacinação da Covid-19 na Região Metropolitana do Recife {.tabset}

## Introdução {.tabset} 
### O começo do **Caos**
Em 31 de dezembro de 2019, a Organização Mundial da Saúde (OMS) foi alertada sobre vários casos de pneumonia na cidade de Wuhan, província de Hubei, na República Popular da China. Tratava-se de uma nova cepa (tipo) de coronavírus que não havia sido identificada antes em seres humanos. 

Uma semana depois foi confirmado o novo tipo de coronavírus e associado como a causa dessa *pneumonia*. 

Em 30 de janeiro de 2020 foi declarada uma emergência de saúde global pela Organização Mundial da Saúde, e dois meses depois, a OMS já tinha conhecimento de mais de meio milhão de casos ao redor do mundo e um pouco mais de 26 mil mortes. O mundo estava conhendo um vírus extremamente contagioso e com um uma taxa de letalidade bem maior em relação a vírus **parecidos**.

No dia 11 de Março de 2020 a OMS elevou o status de surto para **pandemia**.

Em Pernambuco, a campanha de vacinação contra a Covid-19 foi iniciada em 18 de janeiro de 2021, mesmo dia em que a primeira remessa de doses dos imunizantes foi enviada ao Estado pelo Ministério da Saúde. A Secretaria Estadual de Saúde (SES-PE) tem organizado a vacinação de acordo com a disponibilidade de doses encaminhadas pelo Governo Federal, responsável pela aquisição e envio para os Estados. Com o inicio da campanha de vacinação foi selecionado grupos prioritários para atender os mais necessitados de primeira instância. Pensando nisso este projeto tem como o intuito  mostrar uma análise dessa campanha e relacionar esses dois anos de vacinação.É possível destacar questões como: Ao longo do ano de 2021 e 2022, como foi distribuída essa vacinação? Quais foram os grupos mais vacinados? Quantos postos foram utilizados e em quais regiões foram mais vacinadas? Quais doses a população de Recife tomou mais?

## Preparação dos dados {.tabset}

### Origem dos dados

Os dados utilizados foram obtidos do **portal de dados abertos da Prefeitura de Recife**. Este portal disponibiliza, de forma pública, dados que são gerados por secretarias e órgãos da gestão municipal. Além de dados referentes a área da saúde, o portal conta informações sobre diversas outras áreas referentes a cidade do 
Recife como a segurança pública, mobilidade urbana, cultura, finanças e diversas outras.



[![](http://dados.recife.pe.gov.br/base/images/logo-dados-recife.png)](http://dados.recife.pe.gov.br/)


### Explicação dos dados    
  Os dados originais promovem o perfil das pessoas que foram vacinas desde o começo da campanha de vacinação de 2021 e 2022, vinha com a inteção de explorar a estatistica das pessoas que tomaram a vacina, os dados originais somado anos de 2021 e 2022 , tornasse em torno de 870Mb, contava com 14 colunas e um pouco mais de 4 milhões de linhas. Onde as colunas são nomeadas, da seguinte forma: **id, faixa_etaria, idade, sexo, raca_cor, municipio, grupo, categoria, lote, vacina_fabricante, descricao_dose, cnes, sistema_origem, data_vacinacao**.
  
```{r echo=TRUE, message=FALSE, warning=FALSE}

#Fazendo o 'rbind' dos dois dataSet de vacinação 2021 e 2022
vacinados2021 <- read_delim("vacinados2021.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
vacinados2022 <- read_delim("vacinados2022.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
vacinados <- rbind(vacinados2021,vacinados2022)
datatable(vacinados[1:3,])
rm(vacinados2021,vacinados2022)

```

### Limpeza de colunas
Para realizar a limpeza desse enorme arquivo, retiramos as colunas ,categoria, faixa_etaria, lote e sistema_origem, cujo consideramos desnecessária para análise exploratória.

```{r echo=FALSE}
## Tabela sem as colunas acima , para exemplificar
vacinados$categoria = NULL
vacinados$faixa_etaria = NULL
vacinados$lote = NULL
vacinados$sistema_origem = NULL
datatable(vacinados[1:2,])
```

### Criação de Coluna e Factor

Foi criada a coluna **grupoEtario** para separar as pessoas em factor, poderiamos ter usado a antiga coluna **faixa_etaria** mas ela era muito diversa e queriamos minimizar as categorias para não expandir desnecessariamente.

```{r warning=T, echo=FALSE}

## Coluna grupo etario

# Função grupoEtario 
grupo_Etario= function (idade ) {
  
  if(is.na(idade)){ return(NULL)}
  else if(idade>=0 & idade<12){ return ("CRIANÇA")}
  else if(idade>=13 & idade<=17){return ("ADOLESCENTE")}
  else if(idade>=18 & idade<=39){return  ("JOVEM ADULTO")}
  else if(idade>=40 & idade<=65){return ("MEIA IDADE")}
  else{return ("IDOSO")}
}

# Criando coluna vazio de Grupo Etario
vacinados["grupoEtario"] <-c("")

# Preenchendo coluna GrupoEtario
vacinados$grupoEtario <- sapply(vacinados$idade,grupo_Etario)
#vacinados2021$grupoEtario <- factor(vacinados2021$grupoEtario)

#Printando datatable
datatable(vacinados[1:10,c(1,10)])

```

Transformamos as colunas **Sexo, raca_cor e vacina_fabricante** em factors e fizemos algumas limpezas para garantir a coerência dos dados.
```{r results='hide'}
vacinados$raca_cor <- factor(vacinados$raca_cor)
vacinados$sexo <- factor(vacinados$sexo)
vacinados$vacina_fabricante <- factor(vacinados$vacina_fabricante)
#Removendo Na's
vacinados <- filter (vacinados,!is.na(idade))
vacinados <- filter (vacinados,!is.na(cnes))

## Removendo '1' e '2' da coluna $Sexo
a <- filter(vacinados,vacinados$sexo != '1' & vacinados$sexo != '2')
#Filtrando os is.na
b <- filter(vacinados, is.na(sexo))
#Concatenando de volta para 'a'
a <- rbind(a,b)
#Jogando vacinados para data set principal
vacinados <- a

#Limpando coluna racca_cor , Indigena estava duplicado
vacinados$raca_cor <- replace(vacinados$raca_cor, vacinados$raca_cor == "ÍNDIGENA","INDÍGENA")
 

```

### Tabela limpa e explicação detalhada
```{r echo=FALSE}
## Tabela limpa e exemplo

## Limpeza de Data Set
vacinadosCopia <- vacinados
 
# Removendo Colunas
vacinados$categoria = NULL
vacinados$faixa_etaria = NULL
vacinados$lote = NULL
vacinados$sistema_origem = NULL

# Função grupoEtario 
grupo_Etario= function (idade ) {
  
  if(is.na(idade)){ return(NULL)}
  else if(idade>=0 & idade<12){ return ("CRIANÇA")}
  else if(idade>=13 & idade<=17){return ("ADOLESCENTE")}
  else if(idade>=18 & idade<=39){return  ("JOVEM ADULTO")}
  else if(idade>=40 & idade<=65){return ("MEIA IDADE")}
  else{return ("IDOSO")}
}

# Criando coluna vazio de Grupo Etario
vacinados["grupoEtario"] <-c("")

# Preenchendo coluna GrupoEtario
vacinados$grupoEtario <- sapply(vacinados$idade,grupo_Etario)


## Removendo '1' e '2' da coluna $Sexo
a <- filter(vacinados,vacinados$sexo != '1' & vacinados$sexo != '2')
#Filtrando os is.na
b <- filter(vacinados, is.na(sexo))
#Concatenando de volta para 'a'
a <- rbind(a,b)
#Jogando vacinados para data set principal
vacinados <- a

#Limpando coluna racca_cor , Indigena estava duplicado
vacinados$raca_cor <- replace(vacinados$raca_cor, vacinados$raca_cor == "ÍNDIGENA","INDÍGENA")
 
#Transformando em Factor 
vacinados$raca_cor <- factor(vacinados$raca_cor)
vacinados$sexo <- factor(vacinados$sexo)
vacinados$vacina_fabricante <- factor(vacinados$vacina_fabricante)
vacinados$grupoEtario <- unlist(vacinados$grupoEtario)
vacinados$grupoEtario <- factor(vacinados$grupoEtario)

#Removendo Na's
vacinados <- filter (vacinados,!is.na(idade))
vacinados <- filter (vacinados,!is.na(cnes))

#update da dataset Copia
vacinadosCopia <- vacinados

datatable(vacinados[1:2,])


```
Explicação de Cada Coluna

- idade -> Não usamos propriamente a idade, mas foi referenciada para criar a **Coluna grupoEtario**

- descricao_dose -> Numero que determina a dose que foi aplicada ao usuario, que vai de 1 à 3.

- cnes-> Sigla significa "Cadastro Nacional de Estabelecimentos de Saúde", retorna o local de vacinação.

- grupoEtario -> Coluna criada para definir o grupo em que se encaixa o perfil da pessoa(Criança,Adolescente,Jovem Adulto,Meia-Idade e Idoso)

- data_vacinacao -> Data em que foi aplicada a vacina, utilizamos bastante esse dado para impulsionar o problema que queremos destacar.



## Pacotes Requeridos

```{r echo=T,}
library(tidyverse)
library(readr)
library(dplyr)
library(DT)
library(knitr)
library(ggplot2)
```

